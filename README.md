# Foc - 矢量控制驱动器

### 项目开发进行中 - 目前处在硬件制作阶段

# 开发日志

### Foc ver0.4Plus

经过验证板后我重新绘制了第四版，由原来的两层板换成了现在的四层板（成本也在直线上升）。目前文件已经提交厂家制作，还没有收到做好的板子，等板子到了我会继续更新这个项目。

#### 3/10/2022 收到板子并焊接好了

新的板子昨天到了，昨晚焊了一个，但发现DRV8301的开关电源输出有问题，本来应该是5V的电压出来只有2.3V。加上3.3V线性稳压后更离谱，只剩1.23V的电压。

遇到问题后我又另外焊了一块板子，想要测试下电路是否正常，好在新焊的板子电源输出正常稳定，电路没问题。今天继续把板子剩余的部分焊完，代码能够下载，屏幕也可以点亮，接下来可以开始写代码测试板子功能了。

![IMG_20220310_134430](https://ferost-myphotos.oss-cn-shenzhen.aliyuncs.com/202203101436361.jpg)

------

#### 下载验证板

算是一个小分支，在第四版出现问题后经过排查怀疑是布线问题，于是做了个验证板来验证自己的猜想。

验证板减去了SWCLK和SWDIO线路上的过孔，单层6mil直连到端口。经测试下载功能正常！屏幕功能也正常！

![IMG_20220228_135435](https://ferost-myphotos.oss-cn-shenzhen.aliyuncs.com/202203071612097.jpg)

------

### Foc ver0.4

第四版的Foc设计已经是寒假的事情了，这一版根据稚晖大佬的思路做了逻辑板，采用半孔工艺，让制作的板子可以焊接在含驱动电路的板子上。这一版的让我对PCB设计的认知更进了一步。

![IMG_20220224_224018](https://ferost-myphotos.oss-cn-shenzhen.aliyuncs.com/202203071612103.jpg)

![IMG_20220224_223931](https://ferost-myphotos.oss-cn-shenzhen.aliyuncs.com/202203071612104.jpg)

但经焊接测试仍旧无法下载进代码，所以静下心来开始找原因出在哪里。这里我用上了信号发生器和示波器，检查线路的信号完整性，发现某些线路输入输出波形的不一样，于是想到可能是布线导致了这个问题。于是又花一个晚上的时间画了一块验证板。

对第四版的颜值还是很满意的！就是屏幕LEDA引脚（背光控制）上的三极管驱动好像有点问题，焊了个0R的电阻上去才能用。

------

### Foc ver0.3

给实验室新成员培训软件占用了我大部分时间，随着开发时间越拖越长，意识到需要做出一些改变了。深思熟虑下决定把主控芯片换为MM32SPIN27，并使用逐飞开源库进行软件部分的开发。由于前两版的失败心态有些炸裂，所以在收到板子后没有焊接测试，而是收拾好心情开始第四版硬件开发。

![1646636768320](https://ferost-myphotos.oss-cn-shenzhen.aliyuncs.com/202203071612105.png)

------

### Foc ver0.2

第二版硬件，收到板子的时间是2021年11月1号，第一次采用四层板。根据前一版的问题做出了调整，将驱动器部分独立了出去，只留下主控部分。经测试代码还是下不进去，尝试解决问题无果，开始下一版硬件的设计制作。

![1646637266433](https://ferost-myphotos.oss-cn-shenzhen.aliyuncs.com/202203071612106.jpg)

![1646637266445](https://ferost-myphotos.oss-cn-shenzhen.aliyuncs.com/202203071612107.png)

------

### Foc ver0.1

Foc的第一版硬件，参考了稚晖大佬的开源FOC项目，驱动芯片使用的是DRV8312，主控是STM32F405。收到板子的时间是2021年9月18号（正好是生日），不过那段时间厦门疫情，没有及时焊起来调试。后经测试主控芯片下不进程序，所以着手开发第二版硬件。

![1646636768310](https://ferost-myphotos.oss-cn-shenzhen.aliyuncs.com/202203071612108.jpg)

![psc](https://ferost-myphotos.oss-cn-shenzhen.aliyuncs.com/202203071612109.jpg)